import{z as V,r as m,o as e}from"./chunk-PVWAREVJ-BQ_Ke5P5.js";import{u as $}from"./useQuery-DHF6e7RT.js";import{u as G}from"./cn-tC5vkuG_.js";import{u as x,I as t}from"./input-B43vsxgu.js";import{B as l,z as o}from"./button-CM93bdqt.js";import{b as p}from"./banner.apis-BUwV-5L1.js";import{m as J}from"./media.apis-CowVtZYo.js";import{D as I,a as W,P as X,b as S,c as q,d as R,e as T,L as i,f as L,S as Y,T as Z}from"./label-Cq4Oo9qY.js";import{C as ee,a as ae,b as se,c as re,d as ne}from"./card-BRZbrZQm.js";import{T as te,a as ie,b as M,c as g,d as le,e as j}from"./table-BHwQUpxa.js";import{I as P}from"./image-Bw9s3xfc.js";import{c as oe}from"./createLucideIcon-TdObXFoJ.js";import"./query-CCu8L-_k.js";import"./index-CRxIWVFI.js";import"./index-BfqRPb-g.js";import"./index-DJJvMmdf.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=oe("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function de(){return[{title:"Stars Group CMS - Banners"}]}const Ee=de,Be=V(function(){var E,B;const[k,y]=m.useState(!1),[n,u]=m.useState(null),[d,c]=m.useState({promotion_name:"",redirect_url:""}),[C,f]=m.useState(null),[w,_]=m.useState(null),b=G(),{data:U=[],isLoading:z}=$({queryKey:["banners"],queryFn:()=>p.getBanners({"relations[image_ar]":"true","relations[image_en]":"true"}).then(a=>a.data)}),F=x({mutationFn:a=>J.upload(a)}),v=x({mutationFn:a=>p.createBanner(a),onSuccess:()=>{b.invalidateQueries({queryKey:["banners"]}),y(!1),h(),o.success("Banner created successfully")},onError:a=>{var s,r;o.error(((r=(s=a.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to create banner")}}),N=x({mutationFn:({id:a,banner:s})=>p.updateBanner(a,s),onSuccess:()=>{b.invalidateQueries({queryKey:["banners"]}),u(null),h(),o.success("Banner updated successfully")},onError:a=>{var s,r;o.error(((r=(s=a.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to update banner")}}),H=x({mutationFn:a=>p.deleteBanner(a),onSuccess:()=>{b.invalidateQueries({queryKey:["banners"]}),o.success("Banner deleted successfully")},onError:a=>{var s,r;o.error(((r=(s=a.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to delete banner")}}),h=()=>{c({promotion_name:"",redirect_url:""}),f(null),_(null)},A=async a=>{a.preventDefault();try{let s,r;C&&(s=(await F.mutateAsync(C)).data.id),w&&(r=(await F.mutateAsync(w)).data.id);const D={...d,...s&&{image_en_id:s},...r&&{image_ar_id:r}};n?N.mutate({id:n.id,banner:D}):v.mutate(D)}catch{o.error("Failed to upload files")}},Q=a=>{h(),u(a),c({promotion_name:a.promotion_name,redirect_url:a.redirect_url||""})},K=a=>{window.confirm("Are you sure you want to delete this banner?")&&H.mutate(a)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Banners"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage promotional banners and advertisements."})]}),e.jsxs(I,{open:k,onOpenChange:()=>{h(),y(a=>!a)},children:[e.jsx(W,{asChild:!0,children:e.jsxs(l,{children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Add Banner"]})}),e.jsxs(S,{className:"max-w-2xl",children:[e.jsxs(q,{children:[e.jsx(R,{children:"Create New Banner"}),e.jsx(T,{children:"Add a new promotional banner to the system."})]}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"promotion_name",children:"Promotion Name"}),e.jsx(t,{id:"promotion_name",value:d.promotion_name,onChange:a=>c(s=>({...s,promotion_name:a.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"redirect_url",children:"Redirect URL (optional)"}),e.jsx(t,{id:"redirect_url",type:"url",value:d.redirect_url,onChange:a=>c(s=>({...s,redirect_url:a.target.value})),placeholder:"https://example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"image_en",children:"English Image"}),e.jsx(t,{id:"image_en",type:"file",accept:"image/*",onChange:a=>{var s;return f(((s=a.target.files)==null?void 0:s[0])||null)},required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"image_ar",children:"Arabic Image"}),e.jsx(t,{id:"image_ar",type:"file",accept:"image/*",onChange:a=>{var s;return _(((s=a.target.files)==null?void 0:s[0])||null)},required:!0})]})]}),e.jsxs(L,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(l,{type:"submit",disabled:v.isPending,children:v.isPending?"Creating...":"Create Banner"})]})]})]})]})]}),e.jsxs(ee,{children:[e.jsxs(ae,{children:[e.jsx(se,{children:"All Banners"}),e.jsx(re,{children:"A list of all promotional banners in the system."})]}),e.jsx(ne,{children:z?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"Loading banners..."})}):e.jsxs(te,{children:[e.jsx(ie,{children:e.jsxs(M,{children:[e.jsx(g,{children:"Images"}),e.jsx(g,{children:"Promotion Name"}),e.jsx(g,{children:"Redirect URL"}),e.jsx(g,{children:"Actions"})]})}),e.jsx(le,{children:U.map(a=>{var s,r;return e.jsxs(M,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex space-x-2",children:[(s=a.image_en)!=null&&s.url?e.jsx("img",{src:a.image_en.url,alt:`${a.promotion_name} (EN)`,className:"w-16 h-10 object-cover rounded border",title:"English"}):e.jsx("div",{className:"w-16 h-10 bg-gray-200 rounded border flex items-center justify-center",children:e.jsx(P,{className:"w-4 h-4 text-gray-400"})}),(r=a.image_ar)!=null&&r.url?e.jsx("img",{src:a.image_ar.url,alt:`${a.promotion_name} (AR)`,className:"w-16 h-10 object-cover rounded border",title:"Arabic"}):e.jsx("div",{className:"w-16 h-10 bg-gray-200 rounded border flex items-center justify-center",children:e.jsx(P,{className:"w-4 h-4 text-gray-400"})})]})}),e.jsx(j,{className:"font-medium",children:a.promotion_name}),e.jsx(j,{children:a.redirect_url?e.jsxs("a",{href:a.redirect_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 hover:underline",children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),"Visit URL"]}):e.jsx("span",{className:"text-gray-400",children:"No redirect"})}),e.jsx(j,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>Q(a),children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>K(a.id),children:e.jsx(Z,{className:"w-4 h-4"})})]})})]},a.id)})})]})})]}),e.jsx(I,{open:!!n,onOpenChange:()=>u(null),children:e.jsxs(S,{className:"max-w-2xl",children:[e.jsxs(q,{children:[e.jsx(R,{children:"Edit Banner"}),e.jsx(T,{children:"Update banner information."})]}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit_promotion_name",children:"Promotion Name"}),e.jsx(t,{id:"edit_promotion_name",value:d.promotion_name,onChange:a=>c(s=>({...s,promotion_name:a.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit_redirect_url",children:"Redirect URL (optional)"}),e.jsx(t,{id:"edit_redirect_url",type:"url",value:d.redirect_url,onChange:a=>c(s=>({...s,redirect_url:a.target.value})),placeholder:"https://example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit_image_en",children:"English Image (optional)"}),e.jsx(t,{id:"edit_image_en",type:"file",accept:"image/*",onChange:a=>{var s;return f(((s=a.target.files)==null?void 0:s[0])||null)}}),((E=n==null?void 0:n.image_en)==null?void 0:E.url)&&e.jsx("img",{src:n.image_en.url,alt:"Current English",className:"w-full h-20 object-cover rounded border"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit_image_ar",children:"Arabic Image (optional)"}),e.jsx(t,{id:"edit_image_ar",type:"file",accept:"image/*",onChange:a=>{var s;return _(((s=a.target.files)==null?void 0:s[0])||null)}}),((B=n==null?void 0:n.image_ar)==null?void 0:B.url)&&e.jsx("img",{src:n.image_ar.url,alt:"Current Arabic",className:"w-full h-20 object-cover rounded border"})]})]}),e.jsxs(L,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>u(null),children:"Cancel"}),e.jsx(l,{type:"submit",disabled:N.isPending,children:N.isPending?"Updating...":"Update Banner"})]})]})]})})]})});export{Be as default,Ee as meta};
